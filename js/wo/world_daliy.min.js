define("wo/world_daliy",["base_package","frame_package","btn_package","wo_config","commom_function","get_template","footer_view","notice","new_alert_v2","slider","app_function","interact_module"],function(e,i){var a=e("zepto"),t=e("wo_config"),n=e("page_control"),o=e("backbone"),d=e("commom_function"),s=e("mustache");e("notice"),e("cookies");var l=e("slider"),r=e("app_function"),_=e("interact_module"),c=e("new_alert_v2");i.route={"world_daliy/:world_daliy_id(/:page)(/:preview)":"world_daliy"},i.new_page_entity=function(){function i(e){g=c.show({text:"\u56fe\u7247\u52a0\u8f7d\u4e2d...",type:"loading",append_target:y.$el,auto_close_time:!1}),d.send_request({url:t.ajax_url.get_world_daliy+"?newspaper_id="+C,callback:function(i){g.close();var t=i.result_data.newspaper_info.photo_list,n=[];a(t).each(function(e,i){0==e&&(b=i.content),k=new q({model:i,idx:e}),n.push(k.$el.html())});var o=new T({idx:t.length});n.push(o.$el.html()),y.$el.find("[data-slide_show_container]").find(".swipe-wrap").html(""),y.$el.find("[data-slide_show_container]").find(".swipe-wrap").html(n.join("")),y.$el.find("[data-slide_show_container]").show(),"function"==typeof e&&e.call(this,t.length);var d=y.$el.find("[data-guest_list]");d.html("");var s=i.result_data.newspaper_info.user_list;a(s).each(function(e,i){var a=new O({model:i});d.append(a.$el)}),u=i.result_data.newspaper_info.newspaper_info.newspaper_id,v=i.result_data.newspaper_info.newspaper_info.title},error:function(){g.close()}})}function p(e,i,a,t){var n=j,o=n.find('[data-silde_show_idx="'+e+'"]'),s=o.find(".target_img"),l=s.attr("data-ori_src"),r=o.attr("data-user_nickname");s.attr("src",l);var _="",c=o.attr("data-header_icon_url");if(_=d.is_empty(r)?o.attr("data-user_des_content"):r+"\uff1a"+o.attr("data-user_des_content"),t&&h(parseInt(e)),m(c,_),0==e){var p=n.find("[data-silde_show_idx]").eq(e+1).find(".target_img"),f=n.find("[data-silde_show_idx]").eq(e+2).find(".target_img");p.attr("src",p.attr("data-ori_src")),f.attr("src",f.attr("data-ori_src"))}else if(0==e%2&&e!=i){var g=n.find("[data-silde_show_idx]").eq(e-1).find(".target_img"),u=n.find("[data-silde_show_idx]").eq(e-2).find(".target_img"),v=n.find("[data-silde_show_idx]").eq(e+1).find(".target_img"),b=n.find("[data-silde_show_idx]").eq(e+2).find(".target_img");g.attr("src",g.attr("data-ori_src")),u.attr("src",u.attr("data-ori_src")),v.attr("src",v.attr("data-ori_src")),b.attr("src",b.attr("data-ori_src"))}else if(e==i){var p=n.find("[data-silde_show_idx]").eq(i-1).find(".target_img"),f=n.find("[data-silde_show_idx]").eq(i-2).find(".target_img");p.attr("src",p.attr("data-ori_src")),f.attr("src",f.attr("data-ori_src"))}}function m(e,i){a(y.el).find("[data-user_des]").html(""),e?a(y.el).find("[data-user_icon_td]").show():a(y.el).find("[data-user_icon_td]").hide(),a(y.el).find("[data-slide_user_icon]").attr("src",e),a(y.el).find("[data-user_des]").html(i)}function h(e){a(y.el).find("[data-cur_page]").html(e)}function f(e){if(e){var i=window.innerWidth,t=window.innerHeight;a(y.el).find(".world-daliy-page_tips").css({width:i+"px",height:t+"px"}),a(y.el).find(".world-daliy-page_tips").show()}else a(y.el).find(".world-daliy-page_tips").hide()}var g,u,v="",b="",w={route:{"world_daliy/:world_daliy_id(/:page)(/:preview)":"world_daliy"},transition_type:"slide",dom_not_cache:!0,ignore_exist:!0};w.initialize=function(){this.render()},w.render=function(){var e=this,i="",t="";r.is_world_app()||r.is_poco_app_and_android_and_can_share()?i='<li data-to_share><em class="share_icon icon icon-bg-common vam"></em><span style="margin-left:12px">\u5206\u4eab</span></li>':(i="",t="world_daliy_no_share_footer");var n='<div class="world-daliy-page_tips" style="display:none"><table cellspacing="0" cellpadding="0" border="0" class="w-100 h-100 colorfff"><tr><td align="center" valign="middle"><div class="txt font_wryh f14 colorfff mb20">\u4fa7\u6ed1\u53ef\u4ee5\u67e5\u770b\u66f4\u591a\u7167\u7247\u54e6</div><div style="width:157px;height:92px"><img src="http://m.poco.cn/mobile/images/guide-pic-314x184.png" class="max-width-height"></div></td></tr></table></div><div class="wraper_con world-daliy-page" style="position:relative;"><div><div class="fade-img w-100"></div><div class="top_btn_container"><div class="back_btn fl dib "><div class="back_icon icon icon-bg-common"></div></div><div class="num fr dib font-arial"><span data-cur_page>0</span>/<span data-total_page>0</span></div></div><div class="wraper_padding" data-mid_pics_container><div class="main_wraper font_wryh color000"><div class="slide_show"><div data-slide_show_container class="swipe" style="width: 100%;display:none"><div class="swipe-wrap h-100" ></div></div></div></div></div><div class="fade-img-btm w-100"></div><div class="user_des_container" style=""><div class="slide_show_des pl10 pr10"><table cellspacing="0" cellpadding="0" border="0" class="w-100 f12 colorfff"><tr><td width="43" valign="top" data-user_icon_td><div class="user_icon middle-center" style="width: 32px;height: 32px;background: rgba(149,149,149,0.1);"><img data-slide_user_icon class="max-width-height" src=""></div></td><td valign="top"><div class="user_des"><div><div data-user_des class="content_txt"></div></div></div></td></tr></table></div></div><div data-btn_container><div class="comment-love-mod footer-dating '+t+'" data-bottom_btn><ul class="clearfix f10"><li data-to_guest><em class="guest_icon icon icon-bg-common vam"></em><span style="margin-left:12px">\u5609\u5bbe</span></li><li data-to_world_daliy_cmt><em class="cmt_icon icon icon-bg-common vam"></em><span style="margin-left:12px">\u8bc4\u8bba</span></li>'+i+'</ul></div></div></div></div><div class="guest_page" style="display:none"><header class="header re tc font_wryh"><div class="ui-btn-header ui-btn-prev radius-2px" style="display:inline-block;position: absolute;left:11px"><span class="icon icon-arrow icon-bg-common"></span></div>\u672c\u671f\u7684\u5609\u5bbe</header><div class="wraper_padding main_container"><div style="padding-top: 54px;padding-bottom:10px" class="main_wraper font_wryh color000"><div data-guest_list class="pl10 pr10"></div></div></div><div data-guest_footer><div class="comment-love-mod footer-dating "><ul class="clearfix f10"><li data-to_send_article style="width:100%;color:#fff"><em class="send_article_icon icon icon-bg-common vam"></em><span style="margin-left:12px">\u7acb\u5373\u6295\u7a3f\uff0c\u6210\u4e3a\u65e5\u62a5\u7684\u9080\u8bf7\u5609\u5bbe\u3002</span></li></ul></div></div></div>';e.$el.append(a(n))},w.events={"tap .back_btn":function(){n.back()},"tap .ui-btn-prev":function(){y.$el.find(".guest_page").hide(),y.$el.find(".world-daliy-page").show()},swiperight:function(){d.get_ua().is_uc||(f(!1),window.localStorage.setItem("world_daliy_tips",1))},swipeleft:function(){d.get_ua().is_uc||(f(!1),window.localStorage.setItem("world_daliy_tips",1))},"tap [data-to_guest]":function(){y.$el.find(".guest_page").show(),y.$el.find(".world-daliy-page").hide()},"tap [data-to_world_daliy_cmt]":function(){n.navigate_to_page("cmt/"+u+"/from_world_daliy")},"tap [data-to_share]":function(){$.show()},"tap [data-to_send_article]":function(){n.navigate_to_page("theme_act")},"tap .world-daliy-page_tips":function(){f(!1),window.localStorage.setItem("world_daliy_tips",1)},"tap [data-silde_show_idx]":function(e){var i=e.gesture.center.pageX;e.gesture.center.pageY;var a=window.innerWidth/2,t=x.getPos(),n=x.getNumSlides(),o=y.$el.find("[data-silde_show_idx]").eq(t);if(1!=o.attr("data-can_not_slide_tag"))if(i>=a){if(t==n-1)return;x.next()}else{if(0==t)return;x.prev()}},"tap [data-can_not_slide_tap]":function(){n.navigate_to_page("cmt/10/from_world_daliy")}},w.window_change=function(e){var i=window.innerWidth,t=window.innerHeight;a(e.el).find("[data-slide_td]").height(t-45),a(e.el).find(".wraper_con").height(t-45),a(e.el).find("[data-mid_pics_container]").height(t-45),a(e.el).find(".main_container").height(d.container_height_with_head()-45),a(y.el).find(".world-daliy-page_tips").css({width:i+"px",height:t+"px"})};var y,x,k,$,j,z,C=0,I="";w.page_init=function(t,n){y=t,C=n[0],j=a(y.el).find("[data-slide_show_container]");var o=e("scroll"),s=a(t.el).find(".wraper_con");s.height(window.innerHeight-45),a(t.el).find("[data-mid_pics_container]").height(window.innerHeight-45),o.new_scroll(a(t.el).find(".main_container"),{view_height:d.container_height_with_head()-45});var c=window.localStorage.getItem("world_daliy_tips");if(c&&0!=c?f(!1):f(!0),r.is_world_app())var m=!0;else if(r.is_poco_app_and_android_and_can_share())var m=!0;else var m=!1;$=new _({just_show_lv2_layout:!0,share_btn_obj:{show:!0,show_share_btn_list:{sina:!0,qqweibo:!0,qqzone:!0,weixin:m},click_btn_callback:function(){},share_btn_list_click_callback:function(e){var i=a(t.el).find("[data-silde_show_idx]").eq(0).find(".target_img"),n=i.attr("src").replace("-c","");n="weixin"==e?d.matching_img_size(n,"ms"):d.matching_img_size(n,"mb");var o=v+" "+b,s="http://wo.poco.cn/world_share.php?share_page=world_daliy&daliy_id="+u;r.can_app_share()?r.app_share(e,n,o,s):this.share_img(e,n,o,s)}}}),s.parent().append($.$el),i(function(e){var i=a(t.el).find("[data_can_slide_item]").length,e=e;a(y.el).find("[data-total_page]").html(i),setTimeout(function(){var i=1;i=n[1]?n[1]:1,x=new l(y.$el.find("[data-slide_show_container]")[0],{speed:400,startSlide:parseInt(i)-1,auto:0,continuous:!0,disableScroll:!1,stopPropagation:!1,init:function(n,d){var n=n,s=!0;i?(n=i,s=!1,h(parseInt(i),parseInt(e)),p(parseInt(i)-1,parseInt(e),"",s)):p(n,parseInt(e)+1,"",s),1==i?a(d).parent().find("[data-silde_show_idx]").eq(-1).css("visibility","hidden"):i==parseInt(e)+1&&a(d).parent().find("[data-silde_show_idx]").eq(0).css("visibility","hidden");var l=a(t.el).find(".user_des");z=o.new_scroll(l,{view_height:50}),a(t.el).find(".user_des_container").show()},callback:function(i,t){var n=a(t).parent().find("[data-silde_show_idx]").eq(0),o=a(t).parent().find("[data-silde_show_idx]").eq(-1);if(2==e)switch(i){case 0:n.css("visibility","visible"),o.css("visibility","hidden");break;case 1:n.css("visibility","visible"),o.css("visibility","visible");break;case 2:n.css("visibility","hidden"),o.css("visibility","visible")}else e>2&&(i>=e-2?(n.css("visibility","hidden"),o.css("visibility","visible")):2>=i&&(n.css("visibility","visible"),o.css("visibility","hidden")))},transitionEnd:function(i){var a=y.$el.find("[data-silde_show_idx]"),t=y.$el.find(".num");1==!a.eq(i).attr("data-can_not_slide_tag")?(h(parseInt(i)+1),t.show()):t.hide(),p(i,e,"",!1),z.scroll_to(0)},moving:function(i,a){if(I=a,console.log("index:"+i),console.log("total:"+e),"left"==a){if(i==e)return x.slide(0,0),void 0}else if(0==i)return x.slide(e,0),void 0}})},100)})};var q=o.View.extend({initialize:function(e){var i=this;i.data=this.model,i.data.idx=e.idx,console.log(i.data.user_info.user_icon),i.data.user_icon=i.data.user_info.user_icon,i.data.user_id=i.data.user_info.user_id,i.data.user_info.nickname&&(i.data.nickname=i.data.user_info.nickname),i.render()},render:function(){var e=this,i=window.innerHeight-45,t='<div data_can_slide_item data-silde_show_idx="{{idx}}" class="slide_show_child_node" data-header_icon_url="{{user_icon}}" data-slide_user_id="{{user_id}}" data-user_nickname="{{nickname}}" data-user_des_content="{{content}}"><div class="slide_show_img"><table border="0" cellspacing="0" cellpadding="0" class="img-box-table w-100 h-100"><tbody><tr><td valign="middle" align="center" style="height:'+i+'px" data-slide_td><div class="loading_container"><div class="tb"><div class="icon-bg-common loading"></div></div></div><img class="target_img" data-ori_src="{{img_url}}"></td></tr></tbody></table></div></div>',n=s.to_html(t,e.data);a(this.el).html(n),a(this.el).find(".user_des")}}),T=o.View.extend({initialize:function(e){var i=this;i.data=this.model||{},i.data.idx=e.idx,i.render()},render:function(){var e=this,i=window.innerHeight,t='<div data-can_not_slide_tag="1" data-silde_show_idx="{{idx}}" class="slide_show_child_node" data-header_icon_url="{{user_icon}}" data-slide_user_id="{{user_id}}" data-user_nickname="{{nickname}}" data-user_des_content="{{content}}"><div class="slide_show_img"><table border="0" cellspacing="0" cellpadding="0" class="img-box-table w-100 h-100"><tbody><tr><td valign="middle" align="center" style="height:'+i+'px" data-slide_td><div class="loading_container"><div class="tb"><div class="icon-bg-common loading"></div></div></div><div style="position:relative;z-index:1003"><div class="world-news m10"><ul class="world-news-list bdb-line mb10 bgcfff"><li data-can_not_slide_tap="1" class="li-world-list pl10 pt10 pr10" data-test_link><div class="bdb-line-e6e pb10"><table border="0" cellspacing="0" cellpadding="0" class="w-100 f12"><tbody><tr><td width="75"><div class="img-box re"><img src="http://image15-c.poco.cn/mypoco/qing/20140228/16/16399676756571488101_120x120_320_170.jpg" class="img_buffer_bg w-100"><div class="fade colorfff w-100 tc f10"><p>03\u670801\u65e5</p></div></div></td><td><div class="f14 color333" style="font-size:16px">\u53f2\u4e0a\u6700\u840c\u690d\u7269\uff0c\u6211\u6765\u62c9\uff01</div></td></tr></tbody></table></div></li></div></div></td></tr></tbody></table></div></div>',n=s.to_html(t,e.data);a(this.el).html(n)},events:{}}),O=o.View.extend({className:"guest_view",initialize:function(){var e=this;e.data=this.model,this.sex=e.data.sex,e.user_id=e.data.user_id,e.render()},render:function(){var e=this,i='<div class="art-user-info"><table border="0" cellspacing="0" cellpadding="0" class="w-100"><tbody><tr><td width="42"><div class="user-pic middle-center"><img class="max-width-height" src="{{user_icon}}"></div></td><td><h4 class="clearfix f12 lh14"><span class="color333 fl">{{nickname}}</span><i class="sex_icon fl icon-bg-common"></i></h4><span class="f12 font-arial color999">{{publish_count}}\u5f20\u7167\u7247</span></td></tr></tbody></table></div>',t=s.to_html(i,e.data);a(this.el).html(t),"\u7537"==this.sex?a(this.el).find(".sex_icon").addClass("icon-male"):"\u5973"==this.sex&&a(this.el).find(".sex_icon").addClass("icon-female")},events:{tap:function(){var e=this;n.navigate_to_page("user_profile/"+e.user_id)}}}),S=e("page").new_page(w);return S}}),"function"==typeof process_add&&process_add();