define("wo/news",["base_package","frame_package","btn_package","commom_function","wo_config","get_template","footer_view","notice","new_alert_v2"],function(e,i){var a=e("zepto"),n=e("page_control"),t=e("backbone"),d=e("commom_function"),o=e("mustache"),s=e("wo_config"),l=e("notice"),r=e("new_alert_v2");i.route={news:"news"},i.new_page_entity=function(){function i(){I.clear_list(),C.each(function(e){var i=new u({model:e,pic_size:h});I.add_list_item(i)}),z.scroll_to(0)}function c(e){var i=new u({model:e,pic_size:h});I.add_list_item(i)}var _,m=10,p=!1,f={ajax_load_finish:function(e,i){_.close(),I.more_btn_reset(),0==i&&p?(j.find(".no_data").css("display","table"),I.hide_more_btn(),I.clear_list()):j.find(".no_data").hide(),null!=i&&((0==i||m>i.length)&&I.hide_more_btn(),z.trigger_scrollend())},before_refresh:function(){p=!0,_=r.show({text:"\u52a0\u8f7d\u4e2d",type:"loading",append_target:k.$el,is_cover:!1,auto_close_time:!1})},before_get_more:function(){p=!1,I.more_btn_loading()}},g=t.Model.extend({defaults:{}}),v=t.Collection.extend({model:g,refresh:function(){f.data={},d.collection_refresh_function.call(this,f)},get_more_item:function(){var e=this;f.data={order_ukey:e.models[e.models.length-1].attributes.order_ukey},d.collection_get_more_function.call(this,f)},parse:function(e){return e&&e.result_data!==void 0?e.result_data:e},url:s.ajax_url.news_list}),h=parseInt((window.innerWidth-20-42-15)/3),u=t.View.extend({className:"border-btm",tagName:"div",idx:0,initialize:function(){var e="like";switch(e){case"like":var i='<table border="0" cellspacing="0" cellpadding="0"><tr><td valign="top" width="42"><div class="user-img middle-center"><img class="img_buffer_bg max-width-height" data-nav_user={{user_id}} lazyload_src="{{user_icon}}" class="radius-3px"/></div></td><td><div class="user-info"><p class="txt"><span class="name" data-nav_user={{user_id}}>{{nickname}} <span class="like_num">&nbsp;\u559c\u6b22\u4e86{{article_count}}\u5f20\u7167\u7247</span></span><span class="time">{{add_time}}</span></p><div class="like-photo clearfix">{{#custom_data}}<img lazyload_src="{{cover_img_url_ss}}" data-nav_art={{art_id}} data-img_width="{{cover_img_url_width}}" data-img_height="{{cover_img_url_height}}" class="img_buffer_bg imgs " style="width:{{pic_size}}px;height:{{pic_size}}px;" >{{/custom_data}}</div></div></td></tr></table>'}var n=this.img_size_sort(this.model.toJSON());this.user_id=n.user_id;var t=o.to_html(i,n);a(this.el).html(t)},img_size_sort:function(e){for(var i=e.custom_data.length,a=0;i>a;a++){var n=e.custom_data[a];n.cover_img_url_ss=d.matching_img_size(n.cover_img_url,"ss"),n.pic_size=h}return e},events:{"tap [data-nav_user]":"navigate_to_user","tap [data-nav_art]":"navigate_to_art"},navigate_to_user:function(){this.user_id&&n.navigate_to_page("user_profile/"+this.user_id)},navigate_to_art:function(e){var i=a(e.currentTarget).attr("data-nav_art"),t=a(e.currentTarget).attr("data-img_width"),d=a(e.currentTarget).attr("data-img_height");n.navigate_to_page("last/"+i+"/from_profile",{cover_img_width:t,cover_img_height:d})}}),b=t.View.extend({initialize:function(){var i=this,n=e("load_more_btn")();a(this.el).parent().append(n.$el),i.load_more_btn=n,i.load_more_btn.hide()},add_list_item:function(e){a(this.el).append(e.$el),this.load_more_btn.show()},clear_list:function(){a(this.el).html("")},hide_more_btn:function(){this.load_more_btn.hide()},more_btn_loading:function(){this.load_more_btn.loadding()},more_btn_reset:function(){this.load_more_btn.reset()},show_more_btn:function(){this.load_more_btn.reset()}}),w={title:"\u597d\u53cb\u52a8\u6001",route:{news:"news"},transition_type:"none"};w.initialize=function(){this.render()};var y;w.render=function(){var i=this,n=e("get_template"),t=e("footer_view");y=new t({cur:"message_port"}),n.template_obj();var d='<div class="wrap-box"><header class="header font_wryh clearfix"><div class="tab-select_container"></div></header><div class="main_wraper" ><div class="friend-act font_wryh content-10 " style="display: none; padding-top:45px;"><div class="no_data" style="font-size: 14px;text-align: center;display:none;width: 100%;height: 95%;"><div style="display: table-cell;width: 200px;height: 200px;text-align: center;vertical-align: middle;">\u4f60\u7684\u597d\u53cb\u8fd8\u6ca1\u6709\u4efb\u4f55\u52a8\u6001\u3002 <br /> \u70b9\u6b64\u5bfb\u627e\u66f4\u591a\u597d\u53cb\u548c\u5173\u6ce8POCO\u8fbe\u4eba\u3002<div class="_add_firends save_btn font_wryh bolder" data-to_add_firends style="margin: 20px 25px;"><span >\u6dfb\u52a0\u597d\u53cb</span></div></div></div><div class="friend_news pb5" style="width: 100%;" style="display: none;"><div class="news-item clearfix" ></div></div></div><div style="overflow:hidden;position:relative;z-index: 1;"><div style="-webkit-transform:translateZ(0px);" ></div></div><div class="content-25 no_login" style="display: none;"><div class="me-page-nologin font_wryh"><table border="0" cellspacing="0" cellpadding="0"><tr><td align="center"><p>\u4f60\u5c1a\u672a\u767b\u5f55\uff0c\u8bf7\u70b9\u51fb\u6309\u94ae\u8fdb\u884c\u767b\u5f55/\u6ce8\u518c\u3002</p><div class="ui-btn-register mt20"><span >\u767b\u5f55</span></div></td></tr></table></div></div></div><footer class="footer"></footer></div>';i.$el.append(a(d)),i.$el.find(".footer").append(y.$el)},w.events={"tap .data-more_btn":function(){return n.page_transit_status()?!1:(C.get_more_item(),void 0)},"tap .ui-btn-refresh-wrap":function(){return n.page_transit_status()?!1:(C.refresh(),void 0)},"tap .no_login":function(){n.navigate_to_page("login")},"tap .ui-btn-user-wrap":function(){n.navigate_to_page("recommend")},"tap .no_data":function(){n.navigate_to_page("recommend")},"tap [data-select_firend_type]":function(e){var i=a(e.currentTarget).attr("data-select_firend_type");"act"==i&&n.navigate_to_page("friend")},swipeleft:function(){d.get_ua().is_uc||n.navigate_to_page("cmt_notice")}},w.window_change=function(e){a(e.el).find(".main_wraper").height(d.container_height_with_head_and_nav())};var x,k,$=0;w.page_before_show=function(e){k=e,a(e.el).find(".main_wraper").height(d.container_height_with_head_and_nav()),window.localStorage.setItem("nav_address","news"),l.footer_notice_ui_refresh();var i=d.get_local_poco_id();a(e.el).find(".main_wraper"),a(e.el).find(".border-btm").length>0&&a(e.el).find(".no_data").hide(),0==i?(e.$el.find(".no_login").show(),I.clear_list(),e.$el.find(".friend-act").hide(),a(e.el).find(".ui-btn-user-wrap").hide(),a(e.el).find(".ui-btn-refresh-wrap").hide(),a(e.el).find(".tab-select").hide(),a(e.el).find(".header").hide(),x=!1,$=0):(a(e.el).find(".header").show(),$!=i&&(e.$el.find(".no_login").hide(),e.$el.find(".no_authorize").hide(),e.$el.find(".friend-act").show(),I.clear_list(),C.refresh(),I.hide_more_btn(),x=!0),$=i,a(e.el).find(".ui-btn-user-wrap").show(),a(e.el).find(".ui-btn-refresh-wrap").show(),a(e.el).find(".tab-select").show(),a(e.el).find(".header_title").html(""))};var z,j,C,I,k,T,O;w.page_init=function(n,t){k=n,O=d.get_local_poco_id(),j=a(n.el),_params_arr=t;var o=e("scroll"),s=a(n.el).find(".main_wraper");z=o.new_scroll(s,{view_height:d.container_height_with_head_and_nav(),use_lazyload:!0}),n.$el.find(".no_login").css("height",d.container_height_with_head_and_nav()),n.$el.find(".no_authorize").css("height",d.container_height_with_head_and_nav()),I=new b({el:a(n.el).find(".news-item")}),message_nav_view=e("message_nav"),message_nav_view_obj=new message_nav_view({cur_link_type:"news",click_cur_nav:function(){O>0&&C.refresh()}}),k.$el.find(".tab-select_container").append(message_nav_view_obj.$el),C||(C=new v),C.bind("reset",i,j),C.bind("add",c,j),T||(O>0&&C.refresh(),T=!0)};var q=e("page").new_page(w);return q}}),"function"==typeof process_add&&process_add();