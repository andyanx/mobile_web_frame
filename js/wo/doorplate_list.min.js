define("wo/doorplate_list",["base_package","frame_package","btn_package","commom_function","wo_config","get_template","footer_view"],function(e,t){var i=e("zepto"),a=e("page_control"),n=e("backbone"),o=e("commom_function"),l=e("wo_config"),r=e("mustache"),s=e("new_alert_v2");t.route={"doorplate_list(/:query)":"doorplate_list"},t.new_page_entity=function(){function t(){if(w.clear_list(),0==y.length%2)var e=parseInt(y.length/2);else var e=parseInt(y.length/2)+1;for(var t=0;e>t;t++)w.add_list_tr(t);y.each(function(e,t){var i=new g({model:e});w.add_list_item(i,t)}),c.find("[data-doorplate_num]").html($),d.scroll_to(0)}function _(e){new g({model:e}),w.add_list_item(e)}var d,c,p,h={transition_type:"slide",dom_not_cache:!0};h.initialize=function(){this.render()};var f={ajax_load_finish:function(e,t){p.close(),c.find("#container").css("visibility","visible"),null!=t&&console.log(t.length)},before_refresh:function(){p=s.show({text:"\u6b63\u5728\u52a0\u8f7d",type:"loading",append_target:c})},before_get_more:function(){}},u=n.Model.extend({defaults:{}}),m=n.Collection.extend({model:u,url:function(){return l.ajax_url.get_doorplate_list+"?user_id="+k},refresh:function(){o.collection_refresh_function.call(this,f)},get_more_item:function(){var e=this;f.data={order_key:e.models[e.models.length-1].attributes.order_ukey},o.collection_get_more_function.call(this,f)},parse:function(e){return e&&e.result_data!==void 0?e.result_data:e}}),g=n.View.extend({tagName:"div",className:"doorplate_item",location:"",initialize:function(){var e=this;e.render()},events:{"tap [data-nav_doorplate_last]":function(){var e=this;a.navigate_to_page("doorplate_last/"+e.medal_id+"/"+k)}},render:function(){var e=this,t=this.model.toJSON(),a="",n="",o="";if(e.location=t.medium_photo_location,0==t.is_have_doorplate){if(k!=b)return;t.name=t.name.replace(/(Lv[0-9]*)|(LV[0-9]*)/,""),a="no_doorplate",n="no_progress"}else $++,0>=t.level&&(n="no_progress",o="has_progres_height");var l=e.img_size_sort(t),s='<div data-nav_doorplate_last class="img_container_td" style="padding-bottom: 10px;margin:0 10px"><div class="img_container_div"><img src="{{medium_photo}}" style="height:{{img_show_height}}px;width:100%;"/><div class="doorplate_content '+o+'"><div class="progress_container_position '+n+'"><table border="0" cellspacing="0" cellpadding="0" style="width: 100%;"><tbody><tr><td><div class="progress_container "><div class="progress_val "></div></div></td><td width="26"><span data-lv_num class="lv_num">Lv.{{level}}</span></td></tr></tbody></table></div><div class="icon_name '+a+'">{{name}}</div></div></div></div>',_=r.to_html(s,l);e.medal_id=l.medal_id,e.is_have_doorplate=l.is_have_doorplate,i(this.el).html(_),0!=t.is_have_doorplate&&t.level>0&&(console.log(t.level),e.show_progress({cur_lv:t.level,total_lv:t.max_level}))},img_size_sort:function(e){var t=window.innerWidth,i=parseInt((t-20-60)/2);return e.img_show_height=parseInt(144*i/240),e},show_progress:function(e){var t=this,e=e||{},i=parseInt(e.cur_lv)||0,a=parseInt(e.total_lv)||5,n=(e.speed||100,e.callback||function(){},null==e.aninmate?!0:!1);if(!(i>a)){t.$el.find(".progress_container");var o=t.$el.find(".progress_val"),l=0;if(console.log(n),n){var r=parseInt(100*(i/a));setTimeout(function(){o.animate({width:r+"%"},300,"ease")},300)}else l=parseInt(100*(i/a)),o.css("width",l+"%")}}}),v=n.View.extend({initialize:function(){},add_list_tr:function(){i(this.el).find("table").append("<tr data-item_tr><td width='50%' valign='top' class='doorplate_item_left' data-doorplate_td></td><td data-doorplate_td  valign='top' class='doorplate_item_right'></td></tr>")},add_list_item:function(e,t){i(this.el).find("[data-doorplate_td]").eq(t).append(e.$el)},clear_list:function(){i(this.el).find(".doorplate_item_left").html(""),i(this.el).find(".doorplate_item_right").html("")}});h.render=function(){var e='<div class="wrap-box"><header class="header font_wryh clearfix"><h3 class="clearfix" style="display:inline-block;width:100%;text-align:center"><span class="pl20"><label data-nick_name></label>\u95e8\u724c(<label data-doorplate_num>0</label>)</span></h3></header><div class="content-10 main_wraper" style="padding: 0 10px;"><div class="doorplate_list mt10 font_wryh" style="position:relative;padding-top:45px;padding-bottom:20px"><div class="font_wryh clearfix" id="container" style="visibility:hidden;padding: 20px 10px 0 10px;background:#fff;position:relative"><div data-icon_list> <table width="100%" border="0" cellspacing="0" cellpadding="0"></table> </div></div></div></div></div>';this.$el.append(i(e))},h.events={"tap .ui-btn-prev-wrap":function(){a.back()},swiperight:function(){o.get_ua().is_uc||a.back()}},h.window_change=function(e){i(e.el).find(".main_wraper").height(o.container_height_with_head()),i(e.el).find(".img_container_div img").css({height:"auto"})},h.page_before_show=function(e){i(e.el).find(".main_wraper").height(o.container_height_with_head())};var b,w,y,x,k,$=0;h.page_init=function(a,n,l){c=i(a.el),x=n,k=x[0]?x[0]:o.get_local_poco_id();var r=i(a.el).find(".main_wraper"),s=e("scroll");d=s.new_scroll(r,{view_height:o.container_height_with_head()});var p=i(a.el).find("header"),h=e("page_back_btn")();p.prepend(h.$el),b=o.get_local_poco_id(),null!=l?l.nick_name===void 0?c.find("[data-nick_name]").html(""):c.find("[data-nick_name]").html(l.nick_name+"\u7684"):c.find("[data-nick_name]").html("\u6211\u7684"),w=new v({el:i(a.el).find("[data-icon_list]")}),y=new m,y.bind("reset",t,a),y.bind("add",_,a),y.refresh()};var j=e("page").new_page(h);return j}}),"function"==typeof process_add&&process_add();