define("wo/notice_list",["base_package","frame_package","btn_package","commom_function","wo_config","get_template","world_list_module","message_nav","user_list_view","user_list_controler","user_list_collection","notice","system_notice_view","no_login"],function(e,i){var a=e("zepto"),n=e("page_control");e("backbone");var t=e("commom_function"),d=e("wo_config"),o=e("new_alert_v2"),s=e("notice");i.route={notice_list:"notice_list"},i.new_page_entity=function(){function i(){console.log(T),T.clear_list(),$.each(function(e){var i=new z({model:e,tpl_type:e.attributes.notice_type_name});T.add_list_item(i)}),c.scroll_to(0),r()}function l(e){var i=new z({model:e,tpl_type:e.attributes.notice_type_name});T.add_list_item(i)}function r(){var e=m.$el.find(".border-btm").length,i=m.$el.find(".main_container"),a=m.$el.find(".no_data");0>=e?(a.show(),i.hide()):(a.hide(),i.show())}var c,_,m,p,f,g,v,h,u,b,w={title:"\u7cfb\u7edf\u901a\u77e5",route:{notice_list:"notice_list"},transition_type:"none"},y=20,x={ajax_load_finish:function(e,i){u.close(),b=!1,a(i).each(function(e,i){1==i.have_unread_before&&(b=!0)}),T.cmt_more_btn_reset(),(0==i||y>i.length)&&!b&&T.hide_more_btn(),f.clear_num()},before_refresh:function(){T.more_btn_loading(),u=o.show({text:"\u52a0\u8f7d\u4e2d",type:"loading",append_target:m.$el,is_cover:!1,auto_close_time:!1})},before_get_more:function(){T.more_btn_loading()}},k=e("user_list_collection"),$=k({url:d.ajax_url.user_notice,refresh:function(){x.data={get_read_status:"unread",notice_group:"normal_group"},t.collection_refresh_function.call(this,x)},get_more_item:function(){var e=this;x.data={get_read_status:"all",notice_group:"normal_group"},e.models.length>0&&1==e.models[e.models.length-1].attributes.have_unread_before?t.collection_refresh_function.call(this,x):t.collection_get_more_function.call(this,x)}}),z=e("system_notice_view"),j=e("user_list_controler");w.initialize=function(){this.render()},w.render=function(){var i=e("get_template");i.template_obj();var n=e("footer_view");footer_view_obj=new n({cur:"message_port"});var t='<div class="wrap-box"><header class="header font_wryh clearfix"><div class="tab-select_container"></div></header><div id="noLogin"></div><div class="content-10 main_wraper"><div class="font_wryh" style="padding-top:45px"><div style="overflow:hidden;position:relative;z-index: 1;"><div style="-webkit-transform:translateZ(0px);"></div></div><div class="main_container pb5"><div class="list-comment-item list-comment-item-padding0"></div></div><div class="no_data" style="display:none;"><div class="me-page-nologin font_wryh"><table border="0" cellspacing="0" cellpadding="0"><tbody><tr><td><div style="text-align:left;line-height: 26px;width: 100%;text-align: center;"><p>\u6682\u65f6\u6ca1\u6709\u4efb\u4f55\u6d88\u606f\u901a\u77e5</p></div></td></tr></tbody></table></div></div></div></div><footer class="footer"></footer></div>';this.$el.append(a(t)),this.$el.find(".footer").append(footer_view_obj.$el)},w.events={"tap .data-more_btn":function(){return n.page_transit_status()?!1:($.get_more_item(),void 0)},"tap .banner_tips":function(e){var i=a(e.currentTarget);i.remove(),window.localStorage.setItem("message_nav_banner_tips",1)},swiperight:function(){t.get_ua().is_uc||n.navigate_to_page("like_notice")}},w.window_change=function(e){a(e.el).find(".main_wraper").height(t.container_height_with_head_and_nav()),m.$el.find(".no_data").height(t.container_height_with_head_and_nav())};var C,I=!0;w.page_before_show=function(e){return a(e.el).find(".main_wraper").height(t.container_height_with_head_and_nav()),m.$el.find(".no_data").height(t.container_height_with_head_and_nav()),window.localStorage.setItem("nav_address","notice_list"),1!=window.localStorage.getItem("message_nav_banner_tips")&&0>=m.$el.find(".banner_tips").length?m.$el.find(".main_container").prepend(t.banner_tips({html_str:"\u518d\u6b21\u70b9\u51fb\u9009\u9879\u5361\u5373\u53ef\u5237\u65b0"})):m.$el.find(".banner_tips").remove(),C=t.get_local_poco_id(),0>=C?(h.show(),m.$el.find(".main_wraper").hide(),m.$el.find(".header").hide(),I=!1,!1):(h.hide(),m.$el.find(".main_wraper").show(),m.$el.find(".header").show(),I?(console.log("normal state"),s.footer_notice_ui_refresh(),f.update_nav_num(),s.get_unread_count_by_type("system")>0&&$.refresh()):(t.get_poco_id(function(e){s.reset_notice_by_data(e.notice_stat),console.log("login just now"),s.footer_notice_ui_refresh(),f.update_nav_num(),$.refresh()},!0),I=!0),void 0)};var T;w.page_init=function(n,d,o){m=n,_=d,p=o,C=t.get_local_poco_id(),v=e("no_login"),h=new v,m.$el.find("#noLogin").append(h.$el),h.hide(),g=e("message_nav"),f=new g({cur_link_type:"notice_list",click_cur_nav:function(){C>0&&$.refresh()}}),m.$el.find(".tab-select_container").append(f.$el),load_more_btn=e("load_more_btn")(),n.$el.find(".load_more_btn_wraper").append(load_more_btn.$el);var s=a(n.el).find(".main_wraper");a(n.el).find(".no_login").height(t.container_height_with_head_and_nav()),m.$el.find(".no_data").height(t.container_height_with_head_and_nav());var r=e("scroll");c=r.new_scroll(s,{view_height:t.container_height_with_head_and_nav()}),T=new j({el:a(n.el).find(".list-comment-item")}),$.bind("reset",i,n),$.bind("add",l,n),C>0&&$.refresh()};var O=e("page").new_page(w);return O}}),"function"==typeof process_add&&process_add();