define("wo/my",["base_package","frame_package","btn_package","commom_function","wo_config","get_template","footer_view","notice","new_alert_v2","app_function"],function(e,i){var a=e("zepto"),n=e("page_control");e("backbone");var t=e("commom_function"),d=e("wo_config"),o=e("notice"),s=e("new_alert_v2");e("cookies");var l=e("app_function");i.route={my:"my"},i.new_page_entity=function(){function i(){var e=t.get_local_poco_id();return t.is_empty(e)?!1:(t.send_request({url:"http://m.poco.cn/mobile/action/to_sign_in.php",data:{sign_tag:"check"},callback:function(e){w=!0;var i=f.$el.find("[sign_inner]"),a=f.$el.find("[btn_icon]"),n=f.$el.find("[btn_txt]"),t=f.$el.find("[sign_tips_1]"),d=f.$el.find("[sign_tips_2]"),o=f.$el.find("[color_control]");0==e.sign?(b=!1,o.removeClass("color999").addClass("color666"),i.removeClass("sign-inner-finish").addClass("sign-inner"),a.removeClass("icon-finish").addClass("icon-bg-common"),n.html("\u5f00\u59cb\u7b7e\u5230")):(b=!0,o.removeClass("color666").addClass("color999"),a.addClass("icon-bg-common icon-finish"),i.removeClass("sign-inner").addClass("sign-inner-finish"),n.html("\u7b7e\u5230\u5b8c\u6210")),t.html(e.tips_1),d.html(e.tips_2)}}),void 0)}function r(){w&&(b||$||($=!0,t.send_request({url:"http://m.poco.cn/mobile/action/to_sign_in.php",data:{sign_tag:"sign"},callback:function(e){var i=f.$el.find(".sign-inner"),a=f.$el.find("[btn_icon]"),n=f.$el.find("[btn_txt]"),t=f.$el.find("[sign_tips_1]"),d=f.$el.find("[sign_tips_2]"),o=f.$el.find("[color_control]");1==e.sign?(b=!0,a.addClass("icon-finish"),n.html("\u7b7e\u5230\u5b8c\u6210"),i.removeClass("sign-inner").addClass("sign-inner-finish"),t.html(e.tips_1),d.html(e.tips_2),o.removeClass("color666").addClass("color999")):s.show({text:"\u7b7e\u5230\u5931\u8d25",type:"info",auto_close_time:1e3})},error:function(){$=!1}})))}function c(e){switch(e){case"cmt":f.$el.find("[data-cmt-msg] .num").hide();break;case"system":f.$el.find("[data-belike-msg] .num").hide();break;case"new_come":f.$el.find("[data-friend-msg] .num").hide(),f.$el.find(".data-my_recommend_point").hide();break;case"edit":f.$el.find(".data-edit_point").hide();break;case"my_life_box":f.$el.find(".data-my_grid_point").hide();break;case"setup":f.$el.find(".data-setup_point").hide();break;case"about":f.$el.find(".data-about_point").hide();break;case"my_wallet":f.$el.find("[data-mywallet_point]").hide();break;case"my_world":f.$el.find(".data-world_point").hide()}o.update_unread_status_by_type(e)}function _(){m("my_world",f.$el.find(".data-world_point"))}function m(e,i){var a=window.localStorage.getItem(e);t.is_empty(a)&&i.show()}var p,f,g,v,h=0,u=!1,b=!1,w=!1,y={route:{my:"my"},transition_type:"none"};y.initialize=function(){this.render()};var x;y.render=function(){var i=e("get_template"),n=e("footer_view");x=new n({cur:"my"});var t=i.template_obj(),d=t.my;this.$el.append(a(d)),this.$el.find(".ui-btn-publish").hide(),this.$el.find(".footer").append(x.$el)},y.events={"tap .ui-btn-refresh-wrap":function(){return f.page_lock?!1:n.page_transit_status()?!1:(g.loadding(),t.get_poco_id(function(e){o.reset_notice_by_data(e.notice_stat),_(),t.set_show_my_wall(e.show_my_wall),g.reset()},!0),i(),void 0)},"tap [data-user_nav]":function(){if(f.page_lock)return!1;var e=t.get_local_poco_id();n.navigate_to_page("user_profile/"+e)},"tap [data-logout_btn]":function(){if(n.page_transit_status())return!1;if(f.page_lock)return!1;var e="\u662f\u5426\u9000\u51fa\u767b\u5f55";confirm(e)&&(f.$el.find(".header").hide(),t.log_out(),f.$el.find(".no_login").show(),f.$el.find(".main_wraper").hide(),f.$el.find(".ui-btn-refresh").hide(),o.update_unread_status_by_type("all"),k=!1,b=!1,$=!1,window.localStorage.setItem("manage_mode",0))},"tap [login_btn]":function(){return n.page_transit_status()?!1:(n.navigate_to_page("login"),void 0)},"tap [data-to_edit]":function(){return f.page_lock?!1:(c("edit"),n.navigate_to_page("edit"),void 0)},"tap [data-to_my_grid]":function(){return f.page_lock?!1:(c("my_life_box"),n.navigate_to_page("my_image_wall"),void 0)},"tap [data-to_recommend]":function(){return f.page_lock?!1:(n.navigate_to_page("recommend"),void 0)},"tap [data-about_nav]":function(){return f.page_lock?!1:(c("about"),n.navigate_to_page("about"),void 0)},"tap [data-setup_nav]":function(){return f.page_lock?!1:(c("setup"),n.navigate_to_page("setup"),void 0)},"tap [data-feedback_nav]":function(){return f.page_lock?!1:(n.navigate_to_page("message_list/100100",{state_tag:"from_my"}),void 0)},"tap [data-to_my_world]":function(){return f.page_lock?!1:(c("my_world"),n.navigate_to_page("my_world"),void 0)},"tap .ui-btn-publish":function(){var e=location.hash.replace("#",""),i=new Image;i.src="http://imgtj.poco.cn/pocotj_touch.css?url=touch://mpoco/mobile/publish_btn?url_hash="+e+"&tmp="+(new Date).getTime(),n.navigate_to_page("publish")},"tap [data-to_my_wallet]":function(){n.navigate_to_page("my_wallet"),c("my_wallet")},"tap .middle":function(){r()},"tap .header":function(){u||(h++,setTimeout(function(){h=0},3e3),3==h&&(null==window.localStorage.getItem("manage_mode")||0==parseInt(window.localStorage.getItem("manage_mode"))?t.send_request({url:d.ajax_url.check_is_admin,data:{t:parseInt((new Date).getTime())},callback:function(e){e.is_admin?(console.log("manage_mode_start"),v=s.show({text:"\u7ba1\u7406\u5458\u6a21\u5f0f\u542f\u52a8\uff01",type:"info",auto_close_time:1e3}),window.localStorage.setItem("manage_mode",1),u=!0,setTimeout(function(){u=!1},3e3),l.app_switch_mode(function(e){alert(e.mode)})):window.localStorage.setItem("manage_mode",0)},error:function(){u=!1}}):(console.log("manage_mode_end"),v=s.show({text:"\u7ba1\u7406\u5458\u6a21\u5f0f\u5173\u95ed\u3002\u3002\u3002",type:"info",auto_close_time:1e3}),window.localStorage.setItem("manage_mode",0),u=!1)))}},y.window_change=function(e){a(e.el).find(".main_wraper").height(t.container_height_with_head_and_nav())};var k=!0;y.page_before_show=function(e){a(e.el).find(".main_wraper").height(t.container_height_with_head_and_nav()),o.footer_notice_ui_refresh();var n=t.get_local_poco_id();0==n?(e.$el.find(".header").hide(),e.$el.find(".no_login").show(),e.$el.find(".main_wraper").hide().css("visibility","visible"),e.$el.find(".ui-btn-refresh").hide(),k=!1):(e.$el.find(".header").show(),e.$el.find(".no_login").hide(),e.$el.find(".main_wraper").show().css("visibility","visible"),e.$el.find(".ui-btn-refresh").show(),k?_():(t.get_poco_id(function(e){o.reset_notice_by_data(e.notice_stat),_(),i()},!0),k=!0))},y.page_init=function(n){f=n,o.set_my_tips_close_storage(1),g=e("refresh_btn")(),n.$el.find(".header").append(g.$el);var d=a(n.el).find(".main_wraper"),s=e("scroll");p=s.new_scroll(d,{view_height:t.container_height_with_head_and_nav()}),n.$el.find(".no_login").css("height",t.container_height_with_head_and_nav()),n.$el.find(".no_authorize").css("height",t.container_height_with_head_and_nav()),_(),i()};var $=!1,z=e("page").new_page(y);return z}}),"function"==typeof process_add&&process_add();