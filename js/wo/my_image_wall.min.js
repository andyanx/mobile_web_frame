define("wo/my_image_wall",["base_package","frame_package","btn_package","commom_function","wo_config","get_template","footer_view","new_alert_v2","img_process","popup"],function(e,i){var a,n,t,d=e("zepto"),o=e("page_control"),s=e("backbone"),l=e("commom_function"),r=e("wo_config"),c=e("mustache"),_=e("new_alert_v2");i.route={my_image_wall:"my_image_wall"},i.new_page_entity=function(){function i(){y.clear_list();for(var e=0;9>e;e++){var i=new u({display_order:e+1});y.add_list_item(i)}x.each(function(e){var i=new h({model:e});y.replace_list_item(i)}),m()}function m(){t=parseInt((window.innerWidth-32)/3),w.find(".grid_box_container").last().width()!=t&&w.find(".grid_box_container").width(t).height(t)}var p={transition_type:"slide",dom_not_cache:!0},f={ajax_load_finish:function(){a.close(),k.reset()},before_refresh:function(){a=_.show({text:"\u6b63\u5728\u52a0\u8f7d",type:"loading",is_cover:!0,append_target:w}),k.loadding()}},g=s.Model.extend({defaults:{}}),v=s.Collection.extend({model:g,url:function(){return r.ajax_url.get_my_wonderful_article_list},refresh:function(){l.collection_refresh_function.call(this,f)},parse:function(e){return e&&e.list!==void 0?e.list:e}}),h=s.View.extend({tagName:"div",className:"grid_box_container bdb-line has_img",initialize:function(e){var i=this;i.no_img_tag=!1,i.reset_tag=e.model.reset_tag,i.options.model=e.model,i.render()},events:{"tap [data-my_life_pic_box]":function(e){var i=this;d(e.currentTarget),o.navigate_to_page("choose_my_image",{font_cover_btn:i,display_order:i.display_order})},"hold [data-my_life_pic_box]":function(){var e=this;e.reset_item(e.display_order),l.send_request({url:r.ajax_url.update_my_image_box,type:"GET",data:{art_id:e.art_id,is_select:0,display_order:e.display_order}}),_.show({text:"\u5df2\u53d6\u6d88",type:"success",auto_close_time:800})}},render:function(){var e=this;if(e.reset_tag)var i=e.options.model;else var i=this.model.toJSON();e.display_order=i.display_order,e.art_id=i.art_id,e.cover_img_url=i.cover_img_url,i.cover_img_url&&(i.cover_img_url=l.matching_img_size(i.cover_img_url,"ss"));var a='{{#cover_img_url}}<img class="my_life_img" src="{{cover_img_url}}">{{/cover_img_url}}{{^cover_img_url}}<table class="has_cover_container" cellspacing="0" cellpadding="0" border="0" width="100%" height="100%"><tr><td align="center" valign="middle"><div class="add_container"><div class="add_icon icon-bg-common"></div><div data-grid_box_txt class="txt">{{cat_name}}</div></div></td></tr></table>{{/cover_img_url}}',n=c.to_html(a,i);d(this.el).html(n),d(this.el).attr({"data-my_life_pic_box":"","data-display_order":e.display_order}),d(this.el).width(t),d(this.el).height(t)},change_font_cover_img:function(e){d(this.el).find("img").attr("src",e)},reset_item:function(e){var i=w.find(".has_img[data-display_order ='"+e+"']"),a=new u({display_order:e});i.before(a.$el),i.remove()}}),u=s.View.extend({tagName:"div",className:"grid_box_container bdb-line white_container no_img",initialize:function(e){var i=this;i.display_order=e.display_order,i.no_img_tag=!0,i.render()},events:{"tap [data-my_life_pic_box]":function(e){var i=this;d(e.currentTarget),console.log("that.display_order:"+i.display_order),o.navigate_to_page("choose_my_image",{font_cover_btn:i,display_order:i.display_order})}},render:function(){var e=this,i='<table class="has_cover_container" cellspacing="0" cellpadding="0" border="0" width="100%" height="100%"><tbody><tr><td align="center" valign="middle"><div class="add_container"><div class="add_icon icon-bg-common"></div></div></td></tr></tbody></table>';d(this.el).html(i),d(this.el).attr({"data-my_life_pic_box":"","data-display_order":e.display_order}),d(this.el).width(t),d(this.el).height(t)},reset_item:function(e,i){if(e){var a=w.find(".no_img[data-display_order ='"+i+"']"),n=new h({model:{cover_img_url:e,display_order:i,reset_tag:!0}});a.before(n.$el),console.log(n.$el),a.remove()}}}),b=s.View.extend({initialize:function(){},add_list_item:function(e){d(this.el).append(e.$el)},replace_list_item:function(e){d(this.el).append(e.$el);var i=e.display_order;if(e.cover_img_url){var a=w.find(".no_img[data-display_order ='"+i+"']");a.before(e.$el),a.remove()}},clear_list:function(){d(this.el).html("")}});p.initialize=function(){this.render()},p.render=function(){var i=e("get_template");i.template_obj();var a='<div class="wrap-box my_grid_life_wrap"><header class="my_grid_life_header header font_wryh clearfix"><h3 class="tc"><span class="user_title"><label></label><span style="display: inline-block;overflow: hidden;">\u6211\u7684\u805a\u5149\u7247</span></span></h3></header><div class="content-8 main_wraper"><div class="my-left-box-page font_wryh" style="padding-top:45px;"><div class="preview_btn_container"><table cellspacing="0" cellpadding="0" border="0" width="100%"><tr><td><div class="des icon-bg-common"></div></td><td align="right"><div class="preview_btn ui-btn-header ui-btn-save radius-2px" style="margin:0;display:inline-block" data-preview_btn><label class="txt" style="font-size:12px;font-weight:normal;">\u9884\u89c8</label></div></td></tr></table></div><div class="grid_box"></div></div></div></div>';this.$el.append(d(a))},p.events={"tap .ui-btn-prev-wrap":function(){o.back()},swiperight:function(){l.get_ua().is_uc||o.back()},"tap .ui-btn-refresh-wrap":function(){return o.page_transit_status()?!1:(x.refresh(),void 0)},"tap [data-preview_btn]":function(){return 0==w.find(".has_img").length?(_.show({text:"\u8fd8\u6ca1\u6709\u9009\u62e9\u56fe\u7247\u54e6!",type:"info",auto_close_time:800}),void 0):(o.navigate_to_page("user_profile/"+$+"/from_preview_image_wall"),void 0)}};var w,y,x,k,$;p.page_back_show=function(){},p.window_change=function(){w.find(".main_wraper").height(l.container_height_with_head()),m()},p.page_init=function(a){if($=l.get_local_poco_id(),0>=$)return _.show({text:"\u5c1a\u672a\u767b\u5f55",type:"info",is_fade:!1,is_cover:!0,auto_close_time:1e3,closed_callback:function(){o.back()}}),!1;window.localStorage.setItem("my_grid_point",1),w=d(a.el);var t=d(a.el).find(".my_grid_life_header"),s=e("page_back_btn")();t.prepend(s.$el),k=e("refresh_btn")(),a.$el.find(".header").append(k.$el);var r=d(a.el).find(".main_wraper"),c=e("scroll");n=c.new_scroll(r,{view_height:l.container_height_with_head()}),y=new b({el:d(a.el).find(".my-left-box-page .grid_box")}),x=new v,x.bind("reset",i,a),x.refresh()};var z=e("page").new_page(p);return z}}),"function"==typeof process_add&&process_add();