define("wo/cmt_notice",["base_package","frame_package","btn_package","commom_function","wo_config","get_template","notice","message_nav","user_list_view","user_list_controler","user_list_collection","system_notice_view","no_login"],function(e,t){var a=e("zepto"),i=e("page_control");e("backbone");var n=e("commom_function"),o=e("wo_config"),s=e("notice"),r=e("new_alert_v2");t.route={cmt_notice:"cmt_notice"},t.new_page_entity=function(){function t(){v.clear_list(),$.each(function(e){if(v.filter_item_model(e))return!1;var t=new j({model:e,tpl_type:"cmt"});v.add_list_item(t)}),c.scroll_to(0),_()}function l(e){if(v.filter_item_model(e))return!1;var t=new j({model:e,tpl_type:"cmt"});v.add_list_item(t)}function _(){var e=p.$el.find(".border-btm").length,t=p.$el.find(".main_container"),a=p.$el.find(".no_data");0>=e?(a.show(),t.hide()):(a.hide(),t.show())}var c,d,p,h,f,m,u,v,g,b,w={title:"\u8bc4\u8bba\u901a\u77e5",route:{cmt_notice:"cmt_notice"},transition_type:"none"},y=20,x={ajax_load_finish:function(e,t){u.close();var i=!1;a(t).each(function(e,t){1==t.have_unread_before&&(i=!0)}),v.cmt_more_btn_reset(),(0==t||y>t.length)&&!i&&v.hide_more_btn(),f.clear_num()},before_refresh:function(){v.more_btn_loading(),u=r.show({text:"\u52a0\u8f7d\u4e2d",type:"loading",append_target:p.$el,is_cover:!1,auto_close_time:!1})},before_get_more:function(){v.more_btn_loading()}},k=e("user_list_collection"),$=k({url:o.ajax_url.my_cmt_list,refresh:function(){x.data={get_read_status:"unread"},n.collection_refresh_function.call(this,x)},get_more_item:function(){var e=this;x.data={get_read_status:"all"},e.models.length>0&&1==e.models[e.models.length-1].attributes.have_unread_before?n.collection_refresh_function.call(this,x):n.collection_get_more_function.call(this,x)}}),j=e("user_list_view"),C=e("user_list_controler");w.initialize=function(){this.render()},w.render=function(){var t=e("get_template");t.template_obj();var i=e("footer_view");footer_view_obj=new i({cur:"message_port"});var n='<div class="wrap-box"><header class="header font_wryh clearfix"><div class="tab-select_container"></div></header><div id="noLogin"></div><div class="content-10 main_wraper"><div class="give-comment-page font_wryh" style="padding-top:45px;"><div class="main_container"><div class="list-comment-item list-comment-item-padding0"></div></div><div class="no_data" style="display:none;"><div class="me-page-nologin font_wryh"><table border="0" cellspacing="0" cellpadding="0"><tbody><tr><td><div style="text-align:left;line-height: 26px;width: 100%;text-align: center;"><p>\u6682\u65f6\u6ca1\u6709\u4efb\u4f55\u6d88\u606f\u901a\u77e5</p></div></td></tr></tbody></table></div></div></div></div><footer class="footer"></footer></div>';this.$el.append(a(n)),this.$el.find(".footer").append(footer_view_obj.$el)},w.events={"tap .ui-btn-prev-wrap":function(){i.back()},"tap .data-more_btn":function(){return i.page_transit_status()?!1:($.get_more_item(),void 0)},"tap .banner_tips":function(e){var t=a(e.currentTarget);t.remove(),window.localStorage.setItem("message_nav_banner_tips",1)},swiperight:function(){n.get_ua().is_uc||i.navigate_to_page("news")},swipeleft:function(){n.get_ua().is_uc||i.navigate_to_page("like_notice")}},w.window_change=function(e){a(e.el).find(".main_wraper").height(n.container_height_with_head_and_nav()),p.$el.find(".no_data").height(n.container_height_with_head_and_nav()-45)};var z,I=!0;w.page_before_show=function(e){return a(e.el).find(".main_wraper").height(n.container_height_with_head_and_nav()),p.$el.find(".no_data").height(n.container_height_with_head_and_nav()-45),window.localStorage.setItem("nav_address","cmt_notice"),1!=window.localStorage.getItem("message_nav_banner_tips")&&0>=p.$el.find(".banner_tips").length?(p.$el.find(".give-comment-page").prepend(n.banner_tips({html_str:"\u518d\u6b21\u70b9\u51fb\u9009\u9879\u5361\u5373\u53ef\u5237\u65b0"})),window.localStorage.setItem("message_nav_banner_tips",0)):p.$el.find(".banner_tips").remove(),z=n.get_local_poco_id(),0>=z?(b.show(),p.$el.find(".main_wraper").hide(),p.$el.find(".header").hide(),I=!1,!1):(b.hide(),p.$el.find(".main_wraper").show(),p.$el.find(".header").show(),I?(console.log("normal state"),s.footer_notice_ui_refresh(),f.update_nav_num(),s.get_unread_count_by_type("cmt")>0&&$.refresh()):(n.get_poco_id(function(e){s.reset_notice_by_data(e.notice_stat),console.log("login just now"),s.footer_notice_ui_refresh(),f.update_nav_num(),$.refresh()},!0),I=!0),void 0)},w.page_init=function(i,o,s){p=i,d=o,h=s,z=n.get_local_poco_id(),g=e("no_login"),b=new g,p.$el.find("#noLogin").append(b.$el),b.hide(),a(i.el).find(".no_login").height(n.container_height_with_head_and_nav()),m=e("message_nav"),f=new m({cur_link_type:"cmt_notice",click_cur_nav:function(){z>0&&$.refresh()}}),p.$el.find(".tab-select_container").append(f.$el);var r=e("scroll"),_=a(i.el).find(".main_wraper");p.$el.find(".no_data").height(n.container_height_with_head_and_nav()-45),c=r.new_scroll(_,{view_height:n.container_height_with_head_and_nav()}),v=new C({el:a(i.el).find(".list-comment-item")}),$.bind("reset",t,i),$.bind("add",l,i),z>0&&$.refresh()};var T=e("page").new_page(w);return T}}),"function"==typeof process_add&&process_add();