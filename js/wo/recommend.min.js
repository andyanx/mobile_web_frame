define("wo/recommend",["base_package","frame_package","btn_package","commom_function","wo_config","get_template","footer_view","notice","user_list_collection","new_alert_v2"],function(e,i){var a=e("zepto"),t=e("page_control");e("backbone");var n=e("commom_function"),d=e("wo_config"),o=e("notice");e("cookies");var s=e("new_alert_v2");i.route={recommend:"recommend"},i.new_page_entity=function(){function i(){var e={};switch(u){case"poco":e.contoller_obj=S,e.collection_obj=w;break;case"sinaweibo":e.contoller_obj=N,e.collection_obj=y;break;case"qqweibo":e.contoller_obj=V,e.collection_obj=x}return e}function l(){var e="";i().contoller_obj.clear_list();var a=i().collection_obj;a.each(function(a){if(a.attributes.relationship&&"error"==a.attributes.relationship)return!0;0!=a.attributes.user_id?(e="recommend",0==a.attributes.is_world_user&&"poco"==u&&(e="invite")):e="invite";var t=new k({model:a,tpl_type:"recommend",select_type:u});i().contoller_obj.add_list_item(t)}),"world"==u&&(j.find('[world_banner="1"]').prepend('<div class="title pl10 pr10 bgcd2d color999" data-master_title="">\u5df2\u52a0\u5165\u4e16\u754c\u7684\u597d\u53cb</div>'),j.find('[recommend_banner="1"]').prepend('<div class="title pl10 pr10 bgcd2d color999" data-master_title="">\u63a8\u8350\u8fbe\u4eba</div>')),z.scroll_to(0)}function r(e){if(!e.attributes.relationship||"error"!=e.attributes.relationship){var a;0!=e.attributes.user_id?(a="recommend",0==e.attributes.is_world_user&&"poco"==u&&(a="invite")):a="invite";var t=new k({model:e,tpl_type:"recommend",select_type:u});i().contoller_obj.add_list_item(t)}}function c(){var e=j.find('[data-for_list="'+u+'"]');e.find(".list-comment-item").hide(),e.find(".no_data_txt").show()}function _(){var e=j.find('[data-for_list="'+u+'"]');e.find(".list-comment-item").show(),e.find(".no_data_txt").hide()}var m,p,f={route:{recommend:"recommend"},transition_type:"slide",dom_not_cache:!0,ignore_exist:!0},h=10,g={ajax_load_finish:function(e,a,t,n){i().contoller_obj.show_more_btn(),i().contoller_obj.more_btn_reset(),T.reset();var d=j.find("[data-select_type='"+u+"']");j.find('[data-for_list="'+u+'"] .loading').hide(),j.find('[data-for_list="'+u+'"] .list-comment-item').show();try{if(0==a.is_bind_sina)return j.find('[data-for_list="sinaweibo"] .list_container').hide(),j.find('[data-for_list="sinaweibo"] .bind_btn').show(),j.find('[data-for_list="sinaweibo"] [data-text]').html("\u4f60\u7684\u65b0\u6d6a\u5fae\u535a\u8d26\u53f7\u5c1a\u672a\u7ed1\u5b9a\u3002"),i().contoller_obj.hide_more_btn(),d.attr("has_read",!0),!1;if(0==a.is_sina_over_time)return j.find('[data-for_list="sinaweibo"] .list_container').hide(),j.find('[data-for_list="sinaweibo"] .bind_btn').show(),j.find('[data-for_list="sinaweibo"] [data-text]').html("\u7531\u4e8e\u65b0\u6d6a\u5fae\u535a\u7684\u76f8\u5173\u89c4\u5b9a\uff0c\u6bcf\u6b21\u7ed1\u5b9a\u4e16\u754c\u7684 \u6709\u6548\u671f\u4e3a90\u5929\u3002\u8fc7\u671f\u9700\u8981\u91cd\u65b0\u7ed1\u5b9a\u3002"),i().contoller_obj.hide_more_btn(),d.attr("has_read",!0),!1;if(0==a.is_bind_qq)return j.find('[data-for_list="qqweibo"] .list_container').hide(),j.find('[data-for_list="qqweibo"] .bind_btn').show(),i().contoller_obj.hide_more_btn(),d.attr("has_read",!0),!1}catch(o){}return null==a?!1:(d.attr("has_read",!0),0==a&&1==n&&c(),(0==a||h>a.length)&&i().contoller_obj.hide_more_btn(),void 0)},before_refresh:function(){T.loadding(),i().contoller_obj.hide_more_btn(),_();var e=j.find('[data-for_list="'+u+'"] .bind_btn');("none"==e.css("display")||0>=e.length)&&(j.find('[data-for_list="'+u+'"] .list-comment-item').hide(),j.find('[data-for_list="'+u+'"] .loading').show())},before_get_more:function(){i().contoller_obj.more_btn_loading(),_()},error_no_alert:!0},v=e("user_list_collection"),u="world",b={url:d.ajax_url.recommend_friend_list,refresh:function(){g.data={friend_type:u},p=n.collection_refresh_function.call(this,g)},get_more_item:function(){var e=this;g.data={order_key:e.models[e.models.length-1].attributes.order_ukey,friend_type:u},p=n.collection_get_more_function.call(this,g)}},w=v(b),y=v(b),x=v(b),k=e("user_list_view"),$=e("user_list_controler");f.initialize=function(){this.render()},f.render=function(){var i=e("get_template"),t=i.template_obj(),n=t.recommend;this.$el.append(a(n))},f.events={"tap .ui-btn-refresh-wrap":function(){return t.page_transit_status()?!1:"world"==u?!1:(i().collection_obj.refresh(),void 0)},"tap .ui-btn-prev-wrap":function(){t.back()},swiperight:function(){n.get_ua().is_uc||t.back()},"tap [data-to_search]":function(){t.navigate_to_page("search_result/"+u)},"tap .bind_btn":function(){t.navigate_to_page("setup")},"tap .data-more_btn":function(){return t.page_transit_status()?!1:(i().collection_obj.get_more_item(),void 0)},"tap [data-select_type]":function(e){p&&p.abort(),T.reset();var t=a(e.currentTarget).attr("data-select_type"),n='[data-for_list="'+t+'"]',d=j.find("[data-for_list]"),o=j.find(n),s=j.find(n+" .scroll_contianer");z=O.new_scroll(s,{view_height:q}),u=t,j.find("[data-select_type]").removeClass("cur"),a(e.currentTarget).addClass("cur");var l="";switch(u){case"world":l="\u641c\u7d22\u4e16\u754c\u597d\u53cb\u7684\u6635\u79f0\u6216\u8005ID";break;case"poco":l="\u641c\u7d22POCO\u597d\u53cb\u7684\u6635\u79f0\u6216\u8005ID";break;case"sinaweibo":l="\u641c\u7d22\u65b0\u6d6a\u5fae\u535a\u597d\u53cb\u7684\u6635\u79f0";break;case"qqweibo":l="\u641c\u7d22\u817e\u8baf\u5fae\u535a\u597d\u53cb\u7684\u6635\u79f0"}j.find("[data-search_input]").attr("placeholder",l),d.css({opacity:"0",visibility:"hidden","z-index":0,left:9999,top:9999}),o.css({opacity:"1",visibility:"visible","z-index":9999,left:0,top:0}),"world"!=u&&(a(e.currentTarget).attr("has_read")||i().collection_obj.refresh())},"tap [data-to_dating]":function(e){var i=a(e.currentTarget).attr("data-to_dating");window.localStorage.setItem("select_sex",i),t.navigate_to_page("dating_list")},"tap [data-to_dating_game]":function(){t.navigate_to_page("dating_game")},"tap [data-to_charm_rank]":function(){t.navigate_to_page("charm_rank")},"tap [data-to_wealth_rank]":function(){t.navigate_to_page("wealth_rank")}},f.window_change=function(){var e=D.find(".scroll_contianer");e.height(q)};var z,j,C,I,T,q,O,S,N,V,D;f.page_init=function(i,c){if(o.set_recommend_tips_close_storage(!0),m=n.get_local_poco_id(),0>=m)return s.show({text:"\u5c1a\u672a\u767b\u5f55",type:"info",is_fade:!1,is_cover:!0,auto_close_time:1e3,closed_callback:function(){t.back()}}),!1;j=a(i.el),I=i,C=c,T=e("refresh_btn")(),i.$el.find(".header").append(T.$el);var _=a(i.el).find("header"),p=e("page_back_btn")();_.prepend(p.$el),D=a(i.el).find('[data-for_list="'+u+'"]');var f=D.find(".scroll_contianer");O=e("scroll"),q=window.innerHeight-d.header_height-104,z=O.new_scroll(f,{view_height:q}),S=new $({el:j.find('[data-for_list="poco"] .list-comment-item')}),N=new $({el:j.find('[data-for_list="sinaweibo"] .list-comment-item')}),V=new $({el:j.find('[data-for_list="qqweibo"] .list-comment-item')}),w.bind("reset",l,i),w.bind("add",r,i),y.bind("reset",l,i),y.bind("add",r,i),x.bind("reset",l,i),x.bind("add",r,i)};var P=e("page").new_page(f);return P}}),"function"==typeof process_add&&process_add();