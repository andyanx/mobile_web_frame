define("wo/get_friends_list",["base_package","frame_package","btn_package","commom_function","wo_config","get_template","footer_view","new_alert_v2"],function(e,i){var a=e("zepto"),n=e("page_control"),t=e("backbone"),d=e("commom_function"),s=e("wo_config"),o=e("mustache"),l=e("new_alert_v2");i.route={"get_friends_list(/:from_tag)":"get_friends_list"},i.new_page_entity=function(){function i(){c(),d.send_request({url:s.ajax_url.get_friends_list,callback:function(e){r(),O=e.result_data,0!=O.length&&(T=q({init_arr:O}),I=T.sort_arr("pinyin"),m(I))},error:function(){x.close()}})}function c(){$.loadding()}function r(){setTimeout(function(){x.close()},300),j.reset(),$.reset()}function m(e){g.find("[data-for_words_list]").html(""),g.find("[data-for_other_list_container]").html(""),0==e.length&&g.find("[data-for_other_list]").hide(),a(e).each(function(e,i){if(V.length>0&&!D){var n=new w({model:"\u6700\u8fd1\u8054\u7cfb\u4eba"});g.find("[data-for_words_list]").prepend(n.$el),a(V).each(function(e,i){var a=new b({model:i,tag:"recent_contacts_tag"});g.find("[data-for_words_list]").append(a.$el)}),D=!0}if(i.title_key){var t=new w({model:i.title_key});g.find("[data-for_words_list]").append(t.$el)}else{var d=new b({model:i});g.find("[data-for_words_list]").append(d.$el)}}),v.scroll_to(0),r()}function _(){if(E=g.find("[data_search_input]").val(),E=a.trim(E),P!=E){if(P=E,""==E)D=!1,m(I);else{var e=T.filter_arr_func(E);m(e)}console.log(E)}}function p(e){for(var i=0;e.length>i;i++)for(var a=i+1;e.length>a;a++)e[i].user_id===e[a].user_id&&(e.splice(a,1),a--);return e.sort(function(e,i){return e-i})}var v,g,f,h={route:{"get_friends_list(/:from_tag)":"get_friends_list"},transition_type:"fade"};h.initialize=function(){this.render()},h.render=function(){var e=this,i='<div class="friend-list-page"><header class="header"><h3 class="tc">\u597d\u53cb\u5217\u8868</h3></header><div class="main_wraper pb10" style="padding-top:45px;"><div class="friend-list" style="position:relative;"><div class="search-item"><div class="search-box radius-2px"><table border="0" cellspacing="0" cellpadding="0"><tbody><tr><td><input type="text" data_search_input class="input-class" placeholder="\u67e5\u627e\u597d\u53cb" style="width: 100%;"/></td><td data_to_search style="padding-left:15px" width="19"><span class="icon-search icon-bg-common"></span></td></tr></tbody></table></div></div><div class="has_data" style="border-top:1px solid #c3c3c3;"><div class="re" id="container"><div data-list_container><div><div class="list-comment-item" data-for_words_list></div><div class="list-comment-item" data-for_other_list style="display:none"><div class="group_title_container"><div class="group_title lh20 f12 color000 fb">\u5176\u4ed6</div></div><div data-for_other_list_container></div></div><div class="load_more_btn_wraper ml10 mr10"></div></div></div><div class="middle_container font_wryh" style="display: none;width: 100%;"><div style="" class="no_data_txt w-100 h-100 f14 tc color666 dtc vam">\u4f60\u8fd8\u6ca1\u6709\u597d\u53cb\u54e6\u3002</div></div></div></div></div></div></div>';e.$el.append(a(i))};var u=!1,b=t.View.extend({tagName:"div",className:"border-btm",initialize:function(){this.render()},events:{"click .border-btm":function(){if(!u)return!1;N.splice(0,0,{user_id:this.user_id,nickname:this.nickname}),N=p(N),N.length>5&&N.pop();var e=JSON.stringify(N);switch(window.localStorage.setItem("recent_contacts_arr",e),S){case"at":console.log(C),C&&C.textarea&&(C.at_params(this.user_id,this.nickname,this.params.at_name),n.back());break;case"message":n.navigate_to_page("message_list/"+this.user_id,{message_user_name:this.nickname})}}},render:function(){var e=this.model;this.user_id=e.user_id,this.nickname=e.nickname,this.sort_key=e.first_key,e.user_icon="http://myicon211-c.poco.cn/"+this.get_icon_filename(e.user_id,64),this.params={user_id:this.user_id,at_name:"@"+this.nickname+" "};var i='<table border="0" cellspacing="0" cellpadding="0"><tbody><tr><td valign="top" width="42" td_1><div class="user-img"><img data-user_icon lazyload_src="{{user_icon}}" class="img_buffer_bg"></div></td><td td_2><div class="user-info"><p class="txt"><span class="name color000">{{nickname}}</span></p></div></td></tr></tbody></table>',n=o.to_html(i,e);a(this.el).html(n),d.is_empty(this.sort_key)||a(this.el).attr("data-sort_key",this.sort_key.toLowerCase())},get_icon_filename:function(e,i){var a=parseInt(e/1e4);if(i)var n=a+"/"+e+"_"+i+".jpg";else var n=a+"/"+e+".jpg";return n}}),w=t.View.extend({tagName:"div",className:"group_title_container",initialize:function(){this.render()},render:function(){var e=this;e.key=this.model,e.sort_key=e.key.toLowerCase();var i='<div data class="group_title lh20 f12 color000 fb">'+e.key+"</div>";a(this.el).html(i)}});h.events={"tap .ui-btn-prev-wrap":function(){n.back()},swiperight:function(){d.get_ua().is_uc||n.back()},"tap .ui-btn-refresh-wrap":function(){D=!1;var e=window.localStorage.getItem("recent_contacts_arr");d.is_empty(e)||(V=JSON.parse(window.localStorage.getItem("recent_contacts_arr"))),i()},"change [data_search_input]":function(){},"tap .data-more_btn":function(){return n.page_transit_status()?!1:(z.get_more_item(),void 0)},"tap [data_to_search]":function(){},"tap .middle_container":function(){n.navigate_to_page("recommend")}},h.window_change=function(e){k=window.innerHeight-s.header_height-60,a(e.el).find("[data-list_container]").height(k),a(e.el).find(".middle_container").height(k)},h.page_before_show=function(e,i,n){N=window.localStorage.getItem("recent_contacts_arr")?JSON.parse(window.localStorage.getItem("recent_contacts_arr")):[],k=window.innerHeight-s.header_height-60,a(e.el).find("[data-list_container]").height(k),a(e.el).find(".middle_container").height(k),C=n,f=setInterval(function(){E=g.find("[data_search_input]").val(),_()},700),setTimeout(function(){u=!0},1e3);var t=window.localStorage;d.is_empty(t.getItem("recent_contacts_arr"))||(V=JSON.parse(t.getItem("recent_contacts_arr")))},h.page_hide=function(){u=!1,g.find("[data_search_input]").blur(),clearInterval(f)};var y,x,k,$,z,j,C,I,O,T,q,N,E="",S="at",P="",V=[],D=!1;h.page_init=function(t,d,o){g=a(t.el),y=d,C=o,S="from_at"==y[0]?"at":"message";var c=a(t.el).find("header"),r=e("page_back_btn")();c.prepend(r.$el),$=e("refresh_btn")(),t.$el.find(".header").append($.$el),j=e("load_more_btn")(),t.$el.find(".load_more_btn_wraper").append(j.$el);var m=a(t.el).find("[data-list_container]");k=window.innerHeight-s.header_height-60;var _=e("scroll");v=_.new_scroll(m,{view_height:k,use_lazyload:!0,scroll_start:function(){g.find("[data_search_input]").blur()}}),a(t.el).find(".middle_container").height(k),x=l.show({text:"\u83b7\u53d6\u4e2d",type:"loading",append_target:g.$el,is_cover:!1,auto_close_time:!1}),e.async("pinyin_lib",function(e){return null==e?(l.show({text:"\u52a0\u8f7d\u5931\u8d25",type:"info",is_fade:!1,is_cover:!0,auto_close_time:1e3,closed_callback:function(){n.back()}}),!1):(q=e,i(),void 0)})};var W=e("page").new_page(h);return W}}),"function"==typeof process_add&&process_add();