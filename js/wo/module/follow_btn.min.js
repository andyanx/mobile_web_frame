define("wo/module/follow_btn",["base_package","wo_config","commom_function","new_alert_v2"],function(e){function t(){var e=n.View.extend({tagName:"span",className:"data-follow_btn",status:"",other_follow_btn:{},initialize:function(e){var t=this,n="";t.user_id=e.user_id,t.status=e.status,t.account_type=e.account_type||0,n=t.switch_tpl(e.status),this.$el.html(n)},events:{tap:"follow_action"},switch_tpl:function(e){var t,n='<span data-is_follow="1" class="ui-icon-add-wrap"><em class="ui-icon-add radius-2px fsn"><i class="icon-atten icon-add icon-bg-common"></i></em></span>',i='<span data-is_follow="0" class="ui-icon-item-wrap"><em class="ui-icon-item radius-2px fsn"><i class="icon-atten icon-xh icon-bg-common"></i></em></span>',a='<span data-is_follow="0" class="ui-icon-item-wrap"><em class="ui-icon-item radius-2px fsn"><i class="icon-atten icon-yi icon-bg-common"></i></em></span>',o='<span data-is_follow="0" class="ui-icon-item-wrap"><em class="ui-icon-item radius-2px fsn"><i class="icon icon-bg-common icon-load"></i></em></span>';switch(e){case"both":t=i;break;case"follow":t=a;break;case"none":t=n;break;case"fans":t=n;break;case"loading":t=o}return t},show:function(){this.$el.show()},hide:function(){this.$el.hide()},follow_action:function(e,t){var n=this;if(!n.onload){n.onload=!0;var r=n.$el.find("[data-is_follow]").attr("data-is_follow");n.reset_btn("loading"),a.send_request({url:i.ajax_url.follow_user,data:{user_id:n.user_id,is_follow:r,account_type:n.account_type,t:parseInt((new Date).getTime())},callback:function(t){1==t.result&&(n.reset_btn(t.follow_status),"follow"==t.follow_status||"both"==t.follow_status?o.show({text:"\u5173\u6ce8\u6210\u529f",auto_close_time:2e3}):("none"==t.follow_status||"fans"==t.follow_status)&&o.show({text:"\u53d6\u6d88\u5173\u6ce8",type:"info",auto_close_time:2e3}),n.options.other_follow_btn&&n.options.other_follow_btn.cid&&n.options.other_follow_btn.reset_btn(t.follow_status)),0==t.result&&(o.show({text:"\u64cd\u4f5c\u5931\u8d25",type:"info",auto_close_time:2e3}),n.reset_btn(n.status)),"function"==typeof e&&e.call(this,t),n.onload=!1},error:function(){"function"==typeof t&&t.call(this),n.reset_btn(n.status),n.onload=!1}})}},reset_btn:function(e){var t=this,n=t.switch_tpl(e);this.$el.parent().find(".data-follow_btn").html(""),this.$el.html(n)}});return e}e("zepto");var n=e("backbone"),i=e("wo_config"),a=e("commom_function"),o=e("new_alert_v2");return t});