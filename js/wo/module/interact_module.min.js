define("wo/module/interact_module",["base_package"],function(e){var t=e("zepto"),i=e("backbone"),a=e("commom_function"),n=e("page_control"),o=e("ua"),s=e("new_alert_v2"),d=e("select_module")(),l=e("wo_config"),r=i.View.extend({className:"pop_interact_module",initialize:function(e){var e=e||{};this.just_show_lv2_layout=e.just_show_lv2_layout||!1,this.show_share_btn_list=e.show_share_btn_list||!1,this.extend_params=e.extend_params||{},this.sort_key_arr=[],this.animate_time=300;for(var t in e){var i=(""+t).replace(/_btn_obj/g,"");this.sort_key_arr.push(i)}this.gift_btn_obj=e.gift_btn_obj,this.gift_btn_obj&&(this.gift_btn_obj.show=e.gift_btn_obj.show||!1,this.gift_btn_obj.click_btn_callback=e.gift_btn_obj.click_btn_callback||function(){}),this.message_btn_obj=e.message_btn_obj,this.message_btn_obj&&(this.message_btn_obj.show=e.message_btn_obj.show||!1,this.message_btn_obj.click_btn_callback=e.message_btn_obj.click_btn_callback||function(){}),this.share_btn_obj=e.share_btn_obj,this.share_btn_obj&&(this.share_btn_obj.show=e.share_btn_obj.show||!1,this.share_btn_obj.count=e.share_btn_obj.count||4,this.share_btn_obj.show_share_btn_list=e.share_btn_obj.show_share_btn_list,this.share_btn_obj.click_btn_callback=e.share_btn_obj.click_btn_callback||function(){},this.share_btn_obj.share_btn_list_click_callback=e.share_btn_obj.share_btn_list_click_callback||function(){}),this.download_btn_obj=e.download_btn_obj,this.download_btn_obj&&(this.download_btn_obj.show=e.download_btn_obj.show||!1,this.download_btn_obj.click_btn_callback=e.download_btn_obj.click_btn_callback||function(){}),this.report_btn_obj=e.report_btn_obj,this.report_btn_obj&&(this.report_btn_obj.show=e.report_btn_obj.show||!1,this.report_btn_obj.click_btn_callback=e.report_btn_obj.click_btn_callback||function(){}),this.refresh_btn_obj=e.refresh_btn_obj,this.refresh_btn_obj&&(this.options.refresh_btn_obj.show=e.refresh_btn_obj.show||!1,this.refresh_btn_obj.click_btn_callback=e.refresh_btn_obj.click_btn_callback||function(){}),this._render(),this.hide()},_render:function(){for(var e=[],t=[],i=0;this.sort_key_arr.length>i;i++){if("gift"==this.sort_key_arr[i]&&this.gift_btn_obj&&this.gift_btn_obj.show&&e.push('<div data-to-gift_list class="first_layout_btn td-send-gift w-100 bdb-line-e1e"><p >\u9001\u793c\u7269</p></div>'),"message"==this.sort_key_arr[i]&&this.message_btn_obj&&this.message_btn_obj.show&&e.push('<div data-to-letter class="first_layout_btn td-letter w-100 bdb-line-e1e"><p >\u53d1\u79c1\u4fe1</p></div>'),"share"==this.sort_key_arr[i]&&this.share_btn_obj&&this.share_btn_obj.show){var a=this.share_btn_obj.show_share_btn_list,n=[];for(var o in a)a[o]&&"sina"==o&&n.push('<td align="center" valign="middle" class="td-sina"><span data-to-share_list="sina" class="icon-wrap radius-2px"><em class="icon icon-sina icon-bg-common"></em></span><p class="mt10">\u65b0\u6d6a\u5fae\u535a</p></td>'),a[o]&&"qqweibo"==o&&n.push('<td align="center" valign="middle" class="td-qqweibo"><span data-to-share_list="qqweibo" class="icon-wrap radius-2px"><em class="icon icon-qqweibo icon-bg-common"></em></span><p class="mt10">\u817e\u8baf\u5fae\u535a</p></td>'),a[o]&&"qqzone"==o&&n.push('<td align="center" valign="middle" class="td-qqzone"><span data-to-share_list="qqzone" class="icon-wrap radius-2px"><em class="icon icon-qqzone icon-bg-common"></em></span><p class="mt10">QQ\u7a7a\u95f4</p></td>'),a[o]&&"weixin"==o&&n.push('<td align="center" valign="middle" class="td-weixin"><span data-to-share_list="weixin" class="icon-wrap radius-2px"><em class="icon icon-weixin icon-bg-common"></em></span><p class="mt10">\u670b\u53cb\u5708</p></td>');for(var s=n.length,d=0,l="",r="",c=0;s>c;c++)d++,l+=n[c],(d==this.share_btn_obj.count||c==s-1)&&(d=0,r='<tr class="color666">'+l+"</tr>",t.push(r),l="",r="")}"download"==this.sort_key_arr[i]&&this.download_btn_obj&&this.download_btn_obj.show&&e.push('<div data-to-download class="first_layout_btn td-download w-100 bdb-line-e1e"><p >\u4e0b\u8f7d</p></div>'),"report"==this.sort_key_arr[i]&&this.report_btn_obj&&this.report_btn_obj.show&&e.push('<div data-to-report class="first_layout_btn td-report w-100 bdb-line-e1e"><p >\u4e3e\u62a5</p></div>'),"refresh"==this.sort_key_arr[i]&&this.refresh_btn_obj&&this.refresh_btn_obj.show&&e.push('<div data-to-refresh class="first_layout_btn td-refresh w-100 bdb-line-e1e"><p >\u5237\u65b0</p></div>')}var _='<div class="fade-page-module w-100 h-100" style="display:none;"></div><div class="pop-personal-wrap w-100 oh color333" data-pop-personal=""><div class="font_wryh"><div class="item bgcfaf" data-first_lv_layout style="display:none"><div class="f14 w-100 color333 " style="text-align:center">'+e.join("")+'</div></div><div data-second_lv_layout class="bdb-line-dcd" style="display:none"><div class="item bgcfaf"><p class="color666" style="text-align: center;padding: 15px 0 5px 0;">\u5206\u4eab\u5230</p><table border="0" cellspacing="0" cellpadding="0" class="w-100 f10"><tbody>'+t.join("")+'</tbody></table></div></div><div class="btn-cancel tc" data-cancel="">\u53d6\u6d88</div><div class="btn-cancel tc" data-sec_cancel="" style="display:none">\u53d6\u6d88</div></div></div>';this.$el.html(_),this.data_pop_personal_obj=this.$el.find("[data-pop-personal]"),this.data_pop_personal_obj.css({bottom:"-30000px"}),this.just_show_lv2_layout&&(this.$el.find("[data-first_lv_layout]").hide(),this.$el.find("[data-second_lv_layout]").show()),this.show_share_btn_list&&(this.$el.find("[data-second_lv_layout]").show(),this.$el.find("[data-second_lv_layout]").show())},show:function(){var e=this;o.isAndroid&&(this.animate_time=0),this.data_pop_personal_obj.css({bottom:-this.data_pop_personal_obj.height()+"px"}),e.bg_show(),this.just_show_lv2_layout?this.data_pop_personal_obj.animate({translate3d:"0px, -"+parseInt(this.data_pop_personal_obj.height())+"px, 0px"},this.animate_time,"ease-in-out"):(e.$el.find("[data-first_lv_layout]").show(),this.data_pop_personal_obj.animate({translate3d:"0px, -"+parseInt(this.data_pop_personal_obj.height())+"px, 0px"},this.animate_time,"ease-in-out"))},hide:function(){var e=this;o.isAndroid&&(this.animate_time=0),this.just_show_lv2_layout?(this.data_pop_personal_obj.animate({translate3d:"0px, 1000px, 0px"},this.animate_time,"ease-in-out"),e.bg_hide()):(this.data_pop_personal_obj.animate({translate3d:"0px, "+parseInt(this.data_pop_personal_obj.height())+"px, 0px"},this.animate_time,"ease-in-out"),e.bg_hide(),e.$el.find("[data-first_lv_layout]").show())},bg_show:function(){var e=this;e.$el.find(".fade-page-module").show()},bg_hide:function(){var e=this;e.$el.find(".fade-page-module").hide()},events:{"tap [data-to-gift_list]":function(){var e=this;"function"==typeof this.gift_btn_obj.click_btn_callback&&(this.gift_btn_obj.click_btn_callback.call(this),e.hide())},"tap [data-to-letter]":function(){var e=this;"function"==typeof this.message_btn_obj.click_btn_callback&&(this.message_btn_obj.click_btn_callback.call(this),e.hide())},"tap [data-to-share]":function(){var e=this;"function"==typeof this.share_btn_obj.click_btn_callback&&this.share_btn_obj.click_btn_callback.call(this),e.$el.find("[data-first_lv_layout]").hide(),e.$el.find("[data-second_lv_layout]").show()},"tap [data-to-download]":function(){var e=this;"function"==typeof this.download_btn_obj.click_btn_callback&&(this.download_btn_obj.click_btn_callback.call(this),e.hide())},"tap [data-to-report]":function(){var e=this;"function"==typeof this.report_btn_obj.click_btn_callback&&(this.report_btn_obj.click_btn_callback.call(this,this.select_report_obj),e.hide())},"tap [data-to-refresh]":function(){var e=this;"function"==typeof this.refresh_btn_obj.click_btn_callback&&(this.refresh_btn_obj.click_btn_callback.call(this),e.hide())},"tap [data-cancel]":function(){var e=this;e.hide()},"tap [data-sec_cancel]":function(){var e=this;e.hide_share_list()},"tap .fade-page-module":function(){var e=this;e.hide()},"tap [data-to-share_list]":function(e){var i=this,a=t(e.currentTarget).attr("data-to-share_list");if("function"==typeof this.share_btn_obj.share_btn_list_click_callback){this.share_btn_obj.share_btn_list_click_callback.call(this,a);var n=new Image;n.src="http://imgtj.poco.cn/pocotj_touch.css?url=touch://mpoco/mobile/share_btn_click"}i.hide()}},init_report_select_control:function(e){var t=new d({options_data:[{key:"\u88f8\u4f53",val:"\u88f8\u4f53"},{key:"\u7248\u6743",val:"\u7248\u6743"},{key:"\u5176\u4ed6",val:"\u5176\u4ed6"}],onchange:function(){var t=this.get_select_data();a.is_empty(t)||a.send_request({url:l.ajax_url.add_report,data:{art_id:e,t:parseInt((new Date).getTime())},callback:function(){s.show({text:"\u4e3e\u62a5\u6210\u529f",type:"info",is_cover:!1,auto_close_time:2e3})}})}});return this.select_report_obj=t,this.select_report_obj},give_gift_action:function(e){var t=a.publish_login_requirement();if(t)return n.navigate_to_page("login"),void 0;var i=a.get_local_poco_id();e==i?s.show({text:"\u81ea\u5df1\u4e0d\u80fd\u7ed9\u81ea\u5df1\u9001\u793c\u7269\uff01",type:"info",is_cover:!1,auto_close_time:1e3}):n.navigate_to_page("send_gift/"+e)},control_nav_to_message_list:function(e){var t=a.publish_login_requirement();if(t)return n.navigate_to_page("login"),void 0;var i=a.get_local_poco_id();i==e?s.show({text:"\u4f60\u4e0d\u80fd\u5411\u81ea\u5df1\u53d1\u79c1\u4fe1\uff01",type:"info",is_cover:!1,auto_close_time:1e3}):n.navigate_to_page("message_list/"+e)},share_img:function(e,t,i,a){var n=encodeURIComponent(t),o=encodeURIComponent(i),s=encodeURIComponent(a);switch(e){case"sina":var d="http://service.weibo.com/share/share.php?title="+o+"&url="+s+"&pic="+n+"&appkey=1684948437&source=bookmark";break;case"qqweibo":var d="http://share.v.t.qq.com/index.php?c=share&a=index&title="+o+"&url="+s+"&pic="+n+"&source=bookmark";break;case"qqzone":var d="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?title="+o+"&summary="+o+"&desc="+o+"&url="+s+"&pics="+n}window.open(d)}});return r}),"function"==typeof process_add&&process_add();